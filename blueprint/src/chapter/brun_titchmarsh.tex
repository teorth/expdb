\chapter{Brun-Titchmarsh type theorems}\label{brun-titchmarsh-chapter}


\begin{definition}[Prime counting function on arithmetic progressions]
Suppose $a,q\in\mathbb Z$ with $\gcd(a,q)=1$. For each $x\geq0$, define
$$\pi(x;q,a)=\sum_{\substack{p\leq x\\p\text{ prime}\\q\mid(p-a)}}1.$$
The ordinary prime counting function can be recovered by $\pi(x)=\pi(x;1,1)$.
\end{definition}

The Prime Number Theorem (PNT) shows that $\pi(x)\sim\frac x{\log x}$ as $x\to\infty$. On the other hand, known results on the asymptotic behavior of $\pi(x;q,a)$ depend greatly on how $q$ and $x$ are sent to $\infty$. Heuristically, it is expected that for ``most'' sequences $q_n,x_n\to\infty$ with $q_n<x_n$, $\pi(x_n;q_n,a)\sim\frac{x_n}{\varphi(q_n)\log(x_n)}$ as $n\to\infty$. Brun-Titchmarsh type theorems make this precise by provide asymptotic upper or lower bounds on $\pi(x;q,a)$ in terms of $\frac x{\varphi(q)\log x}$ or related quantities, presupposing constraints between $q$ and $x$.

\begin{definition}[Logarithmic integral function]
Define the offset logarithmic integral function for $x\geq2$ by $\operatorname{Li}(x)=\int_2^x\frac{\mathrm du}{\log u}$. Note that $\operatorname{Li}(x)\sim\frac x{\log x}$.
\end{definition}

We first record two early results which recover the correct asymptotic under stringent assumptions.

\begin{theorem}[Brun-Titchmarsh theorem under GRH (1929) \cite{titchmarsh_divisor_1930}]\label{titchmarsh-GRH-asymptotic}
Under the Generalized Riemann Hypothesis (GRH), if $q<x$, then
$$\pi(x;q,a)=\frac{\operatorname{Li}(x)}{\varphi(q)}+O(x^{1/2}\log x).$$
\end{theorem}

\begin{theorem}[Walfisz (1936) \cite{walfisz_1936}]\label{walfisz-small-q-asymptotic}
Fix $B\geq0$ and suppose $q\leq(\log x)^B$. Then there exists $A=A(B)>0$ such that
$$\pi(x;q,a)=\frac{\operatorname{Li}(x)}{\varphi(q)}+O(x\exp(-A\sqrt{\log x})).$$
\end{theorem}

\section{Upper bounds}
Titchmarsh's original theorem establishes a coarse asymptotic upper bound.

\begin{theorem}[Brun-Titchmarsh theorem (1929) \cite{titchmarsh_divisor_1930}]
If $0<\theta<1$ and $q\leq x^\theta$, then
$$\pi(x;q,a)=O\left(\frac x{\varphi(q)\log x}\right)+O(x^{6(1-\theta)/7}).$$
\end{theorem}

Later bounds more generally bound the number of prime numbers equivalent to $a\pmod q$ in the interval $[x,x+y]$. Observe that setting $x=0$ indeed yields an improvement on previous results.

\begin{theorem}[Lint, Richert (1965) \cite{lint_richert_1965}]
If $y>q$, then
$$\pi(x+y;q,a)-\pi(x;q,a)<\frac{2y}{\varphi(q)\log(y/q)}\min\left(\frac32,1+\frac6{\log(y/q)}\right).$$
\end{theorem}

\begin{theorem}[Montgomery, Vaughan (1973) \cite{montgomery_vaughan_1973}]
If $y>q$, then
$$\pi(x+y;q,a)-\pi(x;q,a)<\frac{2y}{\varphi(q)\log(y/q)}.$$
\end{theorem}

On the other hand, various bounds improve on this result under polynomial relationships of the form $q\leq x^\theta$. To state these, we need the following definition.
\begin{definition}[$\theta$ and $C_\theta$]
Suppose $x>0$ and $q\in\mathbb Z$. Define $\theta:=\frac{\log q}{\log x}$, and let $C_\theta>0$ be the smallest constant such that
$$\max_{a:\gcd(a,q)=1}\pi(x;q,a)\leq\frac{(C_\theta+o(1))x}{\varphi(q)\log(x)}$$
as $x\to\infty$.
\end{definition}

Here is the historical progression of bounds on $C_\theta$, where
\begin{align}
\nonumber C_1(\theta) =&\ - \frac{66}{33 - 16 \theta} \int_{2}^{4} \frac{\log(t-1)}{t} d t \\
\nonumber & + \frac{8}{4 - \left(3 + \frac{7}{64} \right) \theta} \int_{\frac{8 - \left(7 + \frac{7}{32} \right) \theta }{4 \theta}}^{\frac{165\left(4-\left(3+\frac{7}{64} \right) \theta \right)}{4(33 - 16 \theta)} - \frac{1}{4}} \frac{\log(t-1)}{t} d t \\
\nonumber & + \frac{8}{4 - \left(1 + \frac{7}{64} \right) \theta} \int_{\max \left(\frac{4- \left(1+ \frac{7}{64} \right) \theta}{2 (2-3 \theta )} - \frac{5}{4}, 2 \right)}^{\frac{8 - \left(7 + \frac{7}{32} \right) \theta }{4 \theta}} \frac{\log(t-1)}{t} d t
\end{align}
and
\begin{align}
\nonumber C_2(\theta) =&\ - \frac{66}{33 - 16 \theta} \int_{2}^{4} \frac{\log(t-1)}{t} d t \\
\nonumber & + \frac{16}{8 - 7 \theta} \int_{\frac{8 - 7 \theta}{4 \theta}}^{\frac{165(8-7 \theta)}{8(33 - 16 \theta)} } \frac{\log(t-1)}{t} d t \\
\nonumber & + \frac{16}{8 - 3 \theta} \int_{\max \left(\frac{9 \theta}{4(2 - 3 \theta)}, 2 \right)}^{\frac{8 - 7 \theta}{4 \theta}} \frac{\log(t-1)}{t} d t.
\end{align}

\begin{table}[ht]
    \def\arraystretch{1.2}
    \centering
    \caption{Historical bounds on $C_\theta$}
    \begin{tabular}{|c|c|c|}
    \hline
    Reference & Range of $\theta$ & Upper bound on $C_\theta$\\
    \hline
    Titchmarsh (1930) & $(0,1)$ & Finite\\
    \hline
    \begin{tabular}{@{}c@{}} van Lint \& Richert (1965) \cite{lint_richert_1965}\\
    Montgomery \& Vaughan (1973) \cite{montgomery_vaughan_1973}\\
    Selberg (1991) \cite{selberg-collected-II}
    \end{tabular} & $(0,1)$ & $2/(1-\theta)$\\
    \hline
    Motohashi (1973) \cite{motohashi_1973} & $(0,1/3)$ & $16/(8-3\theta)$\\
    \hline
    Motohashi (1974) \cite{motohashi_1974} & $(0,1/3]$ & $2$ (on LH)\\
    \hline
    Motohashi (1973) \cite{motohashi_1973} & $(2/5,1/2]$ & $2/(2-3\theta)$\\
    \hline
    Motohashi (1974) \cite{motohashi_1974} & $[1/3,2/5]$ & $4/(2-\theta)$\\
    \hline
    Motohashi (1974) \cite{motohashi_1974} & $[1/3,2/5]$ & $2/(2-3\theta)$ (on LH)\\
    \hline
    Goldfeld (1975) \cite{goldfeld_1975} & $(0,24/71)$ & $16/(8-3\theta)$\\
    \hline
    Iwaniec (1982) \cite{iwaniec_1982} & $(0,9/20)$ & $16/(8-3\theta)$\\
    \hline
    Iwaniec (1982) \cite{iwaniec_1982} & $(0,9/20)$ & $8/(4-2\theta)$ (if $q$ cube-free)\\
    \hline
    Iwaniec (1982) \cite{iwaniec_1982} & $[9/20,2/3]$ & $8/(6-7\theta)$\\
    \hline
    Baker (1996) \cite{baker} & $(9/20,1/2)$ & $4/(2-\theta)$\\
    \hline
    Friedlander \& Iwaniec (1997) \cite{friedlander_iwaniec_1997} & $[6/11,1)$ & $(2-((1-\theta)/4)^6)/(1-\theta)$\\
    \hline
    Maynard (2013) \cite{maynard_2013} & $(0,1/8]$ & $2$\\
    \hline
    Bourgain \& Garaev (2014) \cite{bourgain_garaev_2014} & $[1-\delta,1)$ & $(2-c_0(1-\theta)^2)/(1-\theta)$\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $(9/20,1/2)$ & $16/(8-(3+7/32)\theta)$ \\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $(9/20,1/2)$ & $16/(8-3\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[1/2,12/23)$ & $8/(5-5\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[12/23,32/61)$ & $32/(32-43\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[32/61,8/15)$ & $24/(16-17\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[8/15,7/13)$ & $48/(40-49\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[7/13,6/11)$ & $16/(11-12\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[6/11,4/7)$ & $32/(28-35\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[9/51,9/11]$ & $160/(89-91\theta)$ (if $q$ smooth square-free)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[1/8,5/12)$ & $2$ (if $q$ smooth square-free)\\
    \hline
    Xi \& Zheng (2024) \cite{xi-zheng} & $[5/12,9/20)$ & $5/(5-6\theta)$ (if $q$ smooth square-free)\\
    \hline
    Xi \& Zheng (2025) \cite{xi-zheng-1} & $[9/20,1/2)$ & $66/(33-16\theta) - C_1(\theta)$ \\
    \hline
    Xi \& Zheng (2025) \cite{xi-zheng-1} & $[9/20,1/2)$ & $66/(33-16\theta) - C_2(\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2025) \cite{xi-zheng-1} & $[3/10,3/4]$ & $24/(15-16\theta)$ (if $q$ smooth square-free)\\
    \hline
    Xi \& Zheng (2025) \cite{xi-zheng-2} & $[1/2,34/67]$ & $240/(184-217\theta)$ (if $q$ prime)\\
    \hline
    Xi \& Zheng (2025) \cite{xi-zheng-2} & $[1/2,(\nu (2 \nu +1))/(4 \nu^2 + \nu + 4)]$ & $\frac{8}{6 - 7 \theta + \frac{2 \nu - (3 \nu + 4) \theta}{\nu (2 \nu - 1)}}$ for every integer $\nu \geq 5$ (if $q$ prime)\\
    \hline
    \end{tabular}
\label{bt-ctheta-table}
\end{table}

Let $\theta_{\mathrm{char}}$ be the least constant such that for every $\eps>0$ there exists $\delta>0$ such that one has a character sum bound of the form
$$ \sum_{l \leq L} \chi(l) \ll L q^{-\delta}$$
whenever $\chi$ is a non-principal character mod $q$ and $L \geq q^{\theta_{\mathrm{char}}}+\eps$.  The Burgess bound \cite{burgess, burgess2} shows that $\theta_{\mathrm{char}} \leq 3/8$, which can be improved to $\theta_{\mathrm{char}} \leq 1/4$ for cube-free $q$.  The extended Lindel\"of hypothesis implies that $\theta_{\mathrm{char}}=0$.

In \cite[Theorem 3]{iwaniec_1982} it was shown that
$$ C_\theta \leq \max( \frac{2}{1 - \theta \theta_{\mathrm{char}}}, \frac{2}{2-12\theta/5}).$$
This was improved in \cite{lou-yao-1986} to
$$ C_\theta \leq \max( \frac{2}{1 - \theta \theta_{\mathrm{char}}}, \frac{2}{8/7-24\theta/35}).$$
A further (complicated) bound on $C_\theta$ in the range $3/7 \leq \theta < 9/20$ may be found in \cite[Theorem 2]{baker}.

In \cite{xi-zheng}, the bound $C_\theta \leq 16/(8-(3+2\theta_{\mathrm{RP}})\theta)$ for $9/20 < \theta < 1/2$ was established, where $\theta_{\mathrm{RP}}$ is the exponent for the Ramanujan--Petersson conjecture for $GL_2(\Q)$.  By the work of Kim and Sarnak \cite{kim2003refined} one has $\theta_{\mathrm{RP}} \leq 7/64$.  One can also convert exponent pairs to bounds on $C_\theta$:

\begin{theorem}[From exponent pairs to Brun--Titchmarsh]\label{convert}\cite[Theorem 1.4]{xi-zheng} If $(k,\ell)$ is an exponent pair, then
    $$ C_\theta \leq \frac{4}{(3+k-\ell) - (3+3k-\ell)\theta}$$
whenever
$$ \frac{1+k-\ell}{2+2k-2\ell} \leq \theta \leq \frac{1+k-\ell}{1+2k-\ell}.$$
\end{theorem}

Averaged versions of the Brun--Titchmarsh inequality were proven in \cite{HooleyBT1}, \cite{Hooleypa}, \cite{iwaniec_1982}, \cite{deshouillers-iwaniec-BT}, \cite{Fouvry1984}, \cite{Fouvry1985} \cite{mikawa_1991}, \cite{baker-harman-1996}, \cite{baker-harman-677}, \cite{FouvryRadziwill2022} and \cite{li_average_2025}.

For any $\theta$, let $C'_\theta$ denote the best constant for which one has an upper bound
$$\pi(x+x^\theta) - \pi(x) \leq (C'_\theta+o(1)) \frac{x^\theta}{\log x}$$
for unbounded $x$.  The following bounds on $C'_\theta$ are known:
\begin{table}[ht]
    \def\arraystretch{1.2}
    \centering
    \caption{Historical bounds on $C'_\theta$}
    \begin{tabular}{|c|c|c|}
    \hline
    Reference & Range of $\theta$ & Upper bound on $C'_\theta$\\
    \hline
    Montgomery \& Vaughan (1973) \cite{montgomery_vaughan_1973} & $(0,1)$ & $2/\theta$ \\
    \hline
    Iwaniec (1982) \cite{iwaniec_1982} & $(1/3,1)$ & $18/(15\theta-2)$ \\
    \hline
    Iwaniec (1982) \cite{iwaniec_1982} & $(1/2,1)$ & $4/(1+\theta)$ \\
    \hline
    Lou \& Yao (1989) \cite{lou-yao-1989} & $(6/11,11/20]$ & $22/(100\theta-45)$ \\
    \hline
    Lou \& Yao (1992) \cite{lou-yao-chebychev} & $(6/11,1]$ & $1.031$ \\
    \hline
    Baker, Harman, \& Pintz (1997) \cite{baker-harman-pintz_goldbach_1997} & $(0.55,1)$ & $1.0001$ \\
    \hline
    R. Li (2025) \cite{li_number_2025} & \begin{tabular}{@{}c@{}} $(0.52,0.521]$ \\
    $(0.521,0.522]$ \\
    $(0.522,0.523]$ \\
    $(0.523,0.524]$ \\
    $(0.524,0.525]$ \\
    $(0.525,0.535]$
    \end{tabular} & \begin{tabular}{@{}c@{}} $2.874$ \\
    $2.700$ \\
    $2.583$ \\
    $2.536$ \\
    $2.437$ \\
    $2.347$ \\
    \end{tabular} \\
    \hline
    \end{tabular}
\label{bt-ctheta'-table}
\end{table}



\section{Lower bounds}
The most basic lower bound is Dirichlet's theorem, stating that $\lim_{x\to\infty}\pi(x;q,a)=\infty$; we shall not record it here. Until relatively recently, good lower bounds were not known on $\pi(x;q,a)$ other than Theorem \ref{walfisz-small-q-asymptotic} for small $q$, but there are many known estimates for the smallest value of $x$ for which $\pi(x;q,a)>0$.

\begin{definition}[Linnik's constant $L$]
Define $L$ to be the infimum over all $L'>0$ where there exists $q_0(L')>0$ such that for all $q\geq q_0(L')$ and $x>q^{L'}$, $\min_{\gcd(a,q)=1}\pi(x;q,a)>0$.
\end{definition}

Here is the historical progression of $L$.

\begin{table}[ht]
    \def\arraystretch{1.2}
    \centering
    \caption{Historical bounds on $L$}
    \begin{tabular}{|c|c|}
    \hline
    Reference & Upper bound on $L$\\
    \hline
    Linnik (1994) \cite{linnik-1} & $<\infty$\\
    \hline
    Pan (1957) \cite{pan_1957} & $10000$\\
    \hline
    Pan (1958) \cite{pan_1958} & $5448$\\
    \hline
    Chen (1965) \cite{chen_1965} & $777$\\
    \hline
    Jutila (1970) \cite{jutila_thesis} & $630$ \\
    \hline
    Jutila (1970) \cite{jutila_1970} & $550$ \\
    \hline
    Chen (1977) \cite{chen_1977} & $168$\\
    \hline
    Jutila (1977) \cite{jutila_linnik} & $80$\\
    \hline
    Graham (1977) \cite{graham_1977} & $36$\\
    \hline
    Graham (1981) \cite{graham_1981} & $20$\\
    \hline
    Chen (1979) \cite{chen_1979} & $17$\\
    \hline
    Wang (1986) \cite{wang_1986} & $16$\\
    \hline
    Chen \& Liu (1989) \cite{chen_liu_1989} & $13.5$\\
    \hline
    Chen \& Liu (1990) \cite{chen-liu-v} & $11.5$\\
    \hline
    Wang (1991) \cite{wang_1991} & $8$\\
    \hline
    Heath-Brown (1992) \cite{heath_brown_least_prime} & $5.5$\\
    \hline
    Meng (2000) \cite{meng} & $4.5$ (if $q$ prime)\\
    \hline
    Meng (2001, 2010) \cite{meng2001} \cite{meng2010} & $4.5$ (if $q$ has bounded cubic part)\\
    \hline
    Xylouris (2009) \cite{xylouris_thesis_2009} & $5.2$\\
    \hline
    Xylouris (2011) \cite{xylouris_2011} & $5.18$\\
    \hline
    Xylouris (2011, 2018) \cite{xylouris_thesis_2011} \cite{xylouris_2018} & $5$\\
    \hline
    Montgomery (1971) \cite{montgomery_topics_1971} & $\frac{5}{2} = 2.5$ (if $q$ is a power of a fixed prime) \\
    \hline
    Forti \& Viola (1973) \cite{Forti-Viola-Linnik1973} & $\frac{45}{20 - \sqrt{3}} = 2.4633 \dots$ (if $q$ is a power of a fixed prime) \\
    \hline
    Jutila (1972) \cite{Jutila-Linnik1972} & $\frac{3 (9 + \sqrt{17})}{16} = 2.4606 \dots$ (if $q$ is a power of a fixed prime) \\
    \hline
    Huxley (1975) \cite{huxley_large_1975b} & $\frac{12}{5} = 2.4$ (if $q$ is a power of a fixed prime) \\
    \hline
    B. Chen (2025) \cite{ChenBin-Linnik2025} & $\frac{7}{3} = 2.3333 \dots$ (if $q$ is a power of a fixed prime) \\
    \hline
    Banks \& Shparlinski (2019) \cite{Banks_Shparlinski_2019} & $\frac{1}{0.4736} = 2.1115 \dots$ (if $q$ is a power of a fixed prime) \\
    \hline
    R. Li (2025) \cite{li_number_2025} & $\frac{1}{0.4752} = 2.1044 \dots$ (if $q$ is a power of a fixed prime) \\
    \hline
    Heath-Brown (1990) \cite{HeathBrownSiegel1990} & \begin{tabular}{@{}c@{}} $3 + \eps$ (under the existence and some conditions of the exceptional character, effective) \\
    $2 + \eps$ (under the existence and some conditions of the exceptional character, ineffective)
    \end{tabular} \\
    \hline
    Friedlander \& Iwaniec (2003) \cite{FI2003} & $\frac{117}{59} = 1.983 \dots$ (under the existence and some conditions of the exceptional character) \\
    \hline
    \end{tabular}
\label{bt-l-table}
\end{table}

Recent work by Maynard \cite{maynard_2013} establishes asymptotic lower bounds for $\pi(x;q,a)$.

\begin{theorem}[Maynard (2013) \cite{maynard_2013}]
For sufficiently large $q$ and $x>q^8$, we have
$$\frac{\log q}{q^{1/2}}\left(\frac x{\varphi(q)\log x}\right)\ll\pi(x;q,a).$$
\end{theorem}

\begin{theorem}[Maynard (2013) \cite{maynard_2013}]
Let $\epsilon>0$. There exists $q_0(\epsilon)>0$ such that for all $q\geq q_0(\epsilon)$,
$$\frac{q^{-\epsilon}x}{\varphi(q)\log x}\ll\pi(x;q,a).$$
\end{theorem}
